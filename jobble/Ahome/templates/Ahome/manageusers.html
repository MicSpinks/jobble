{% extends base_template %}
{% load static %}

{% block content %}
<div class="container py-4">
	<h1 class="mb-4">Users</h1>

	<div class="row">
		{% for user in users %}
		<div class="col-md-6 col-lg-4 mb-4">
			<div class="card shadow-sm h-100">
				<div class="card-body">
					<h5 class="card-title">{{ user.username }}</h5>
					<h6 class="card-subtitle mb-2 text-muted">{{ user.email }}</h6>
					<p class="card-text">
						<strong>First name:</strong> {{ user.fname|default:"—" }}<br>
						<strong>Last name:</strong> {{ user.lname|default:"—" }}<br>
						<strong>Date joined:</strong> {{ user.date_joined|date:"M d, Y H:i" }}<br>
						<strong>Active:</strong> {{ user.is_active|yesno:"Yes,No" }}<br>
						<strong>Staff:</strong> {{ user.is_staff|yesno:"Yes,No" }}
					</p>

					{% if request.user.is_superuser %}
					<!-- Role Change Form -->
					<form action="{% url 'Ahome.change_role' user.id %}" method="post" class="mb-2">
						{% csrf_token %}
						<div class="input-group input-group-sm">
							<select name="role" class="form-select">
								{% if user.role == "user" %}
								<option value="user" selected>User</option>
								{% else %}
								<option value="user">User</option>
								{% endif%}

								{% if user.role == "recruiter" %}
								<option value="recruiter" selected>Recruiter</option>
								{% else %}
								<option value="recruiter">Recruiter</option>
								{% endif %}
							</select>
							<button type="submit" class="btn btn-primary btn-sm">Update</button>
						</div>
					</form>
					<form action="{% url 'Ahome.delete_user' user.id %}" method="post" class="d-inline">
						{% csrf_token %}
						<button type="submit" class="btn btn-danger btn-sm"
							onclick="return confirm('Are you sure you want to delete this user?');">
							Delete
						</button>
					</form>
					{% endif %}
				</div>
			</div>
		</div>
		{% empty %}
		<p>No users found.</p>
		{% endfor %}
	</div>
</div>
{% endblock content %}